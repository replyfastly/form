<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="ReplyFastly - Question√°rio de Valida√ß√£o">
    <title>ReplyFastly - Question√°rio</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>
    <div id="root"></div>
    
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script type="text/babel">
        const { useState } = React;
        const { createRoot } = ReactDOM;

        // √çcones Lucide simplificados
        const CheckCircle2 = ({ className }) => (
            <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
            </svg>
        );

        const Circle = ({ className }) => (
            <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <circle cx="12" cy="12" r="10" strokeWidth={2} />
            </svg>
        );

        const ChevronRight = ({ className }) => (
            <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 5l7 7-7 7" />
            </svg>
        );

        const ChevronLeft = ({ className }) => (
            <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15 19l-7-7 7-7" />
            </svg>
        );

        const Zap = ({ className }) => (
            <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M13 10V3L4 14h7v7l9-11h-7z" />
            </svg>
        );

        function ReplyFastlyValidationSurvey() {
            const [currentQuestion, setCurrentQuestion] = useState(0);
            const [answers, setAnswers] = useState({});
            const [showResults, setShowResults] = useState(false);
            const [contactInfo, setContactInfo] = useState({ whatsapp: '+55', name: '', country: 'BR' });

            const countryPrefixes = {
                'BR': '+55',
                'PT': '+351',
                'ES': '+34',
                'AU': '+61',
                'IN': '+91',
                'OTHER': '+'
            };

            // ========== GOOGLE SHEETS INTEGRATION ==========
            const GOOGLE_SHEETS_WEBHOOK = 'https://script.google.com/macros/s/AKfycbxwitYA_Szrhaa-WGsLD0ZxqrHCW8TARoqDa5ylY_IKhSWKipF6UjsawKW_kV07YhK-/exec';

            const calculateScore = (answersData) => {
                let score = 0;
                if (answersData.q3?.option === 'a') score++;
                if (answersData.q4?.option === 'a') score++;
                if (['c', 'd', 'e'].includes(answersData.q5?.option)) score++;
                if (['a', 'b'].includes(answersData.q7?.option)) score++;
                return score;
            };

            const getQuality = (score) => {
                if (score >= 4) return 'HOT_LEAD';
                if (score === 3) return 'WARM_LEAD';
                if (score === 2) return 'COLD_LEAD';
                return 'LOW_INTEREST';
            };

            const getInterestLevel = (score) => {
                if (score === 4) return 'Grande';
                if (score === 3) return 'M√©dio';
                if (score === 2) return 'Pequeno';
                return 'Nenhum';
            };

            const sendToGoogleSheets = async (answersData, contactData) => {
                try {
                    const score = calculateScore(answersData);
                    const quality = getQuality(score);
                    
                    const data = {
                        name: contactData.name,
                        whatsapp: contactData.whatsapp,
                        country: contactData.country,
                        score: score,
                        quality: quality,
                        q1_value: answersData.q1?.option || '',
                        q1_custom: answersData.q1?.custom || '',
                        q2_value: answersData.q2?.option || '',
                        q2_custom: answersData.q2?.custom || '',
                        q3_value: answersData.q3?.option || '',
                        q3_custom: answersData.q3?.custom || '',
                        q4_value: answersData.q4?.option || '',
                        q5_value: answersData.q5?.option || '',
                        q6_value: answersData.q6?.options ? Object.keys(answersData.q6.options).filter(k => answersData.q6.options[k]).join(', ') : '',
                        q6_custom: answersData.q6?.customs ? Object.values(answersData.q6.customs).filter(Boolean).join(', ') : '',
                        q7_value: answersData.q7?.option || ''
                    };

                    await fetch(GOOGLE_SHEETS_WEBHOOK, {
                        method: 'POST',
                        mode: 'no-cors',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify(data)
                    });

                    console.log('‚úÖ Dados enviados ao Google Sheets com sucesso!');
                    return true;
                } catch (error) {
                    console.error('‚ùå Erro ao enviar ao Google Sheets:', error);
                    return false;
                }
            };
            // ========== FIM GOOGLE SHEETS ==========

            const handleCountryChange = (newCountry) => {
                setContactInfo({
                    ...contactInfo,
                    country: newCountry,
                    whatsapp: countryPrefixes[newCountry]
                });
            };

            const questions = [
                {
                    id: 'q1',
                    question: 'Como voc√™ gerencia conversas com clientes hoje?',
                    type: 'single',
                    options: [
                        { id: 'a', text: 'Eu mesma respondo tudo', value: 'self_manage' },
                        { id: 'b', text: 'Tenho algu√©m que ajuda', value: 'has_help' },
                        { id: 'c', text: 'Uso alguma ferramenta', value: 'uses_tool' },
                        { id: 'd', text: 'Outro', value: 'other', hasInput: true }
                    ]
                },
                {
                    id: 'q2',
                    question: 'Qual o MAIOR problema em atender clientes pelo WhatsApp?',
                    type: 'single',
                    options: [
                        { id: 'a', text: 'N√£o consigo responder r√°pido (perco clientes)', value: 'slow_response' },
                        { id: 'b', text: 'Interrompe meu trabalho/vida pessoal', value: 'interruptions' },
                        { id: 'c', text: 'Dif√≠cil agendar sem conflitos', value: 'scheduling' },
                        { id: 'd', text: 'Clientes perguntam sempre a mesma coisa', value: 'repetitive' },
                        { id: 'e', text: 'Outro', value: 'other', hasInput: true }
                    ]
                },
                {
                    id: 'q3',
                    question: 'Voc√™ paga algu√©m para atender por voc√™?',
                    type: 'single',
                    options: [
                        { id: 'a', text: 'Sim', value: 'yes', hasInput: true, inputLabel: 'Quanto? (s√≥ n√∫mero)' },
                        { id: 'b', text: 'N√£o, mas gostaria', value: 'would_like' },
                        { id: 'c', text: 'N√£o, atendo eu mesma', value: 'no' },
                        { id: 'd', text: 'J√° tentei mas n√£o deu certo', value: 'tried_failed' }
                    ]
                },
                {
                    id: 'q4',
                    question: 'Se existisse uma assistente inteligente (IA) que respondesse seus clientes 24/7, agendasse automaticamente e nunca errasse, voc√™ usaria?',
                    type: 'single',
                    options: [
                        { id: 'a', text: 'Com certeza', value: 'definitely' },
                        { id: 'b', text: 'Talvez, depende do pre√ßo', value: 'depends_price' },
                        { id: 'c', text: 'N√£o confio em IA', value: 'no_trust' },
                        { id: 'd', text: 'Prefiro pessoa real', value: 'prefer_human' }
                    ]
                },
                {
                    id: 'q5',
                    question: 'Quanto voc√™ pagaria por m√™s por isso?',
                    type: 'single',
                    options: [
                        { id: 'a', text: 'R$ 0-50', value: '0-50' },
                        { id: 'b', text: 'R$ 50-100', value: '50-100' },
                        { id: 'c', text: 'R$ 100-200', value: '100-200' },
                        { id: 'd', text: 'R$ 200-500', value: '200-500' },
                        { id: 'e', text: 'R$ 500+', value: '500+' }
                    ]
                },
                {
                    id: 'q6',
                    question: 'O que seria ESSENCIAL nessa ferramenta?',
                    type: 'multiple',
                    options: [
                        { id: 'a', text: 'Responder perguntas b√°sicas', value: 'auto_reply' },
                        { id: 'b', text: 'Agendar sem conflitos', value: 'scheduling' },
                        { id: 'c', text: 'Coletar informa√ß√µes do cliente antes', value: 'qualify' },
                        { id: 'd', text: 'Nunca vazar minhas informa√ß√µes pessoais', value: 'privacy' },
                        { id: 'e', text: 'Parecer que sou EU respondendo', value: 'personalization' },
                        { id: 'f', text: 'Outro', value: 'other', hasInput: true }
                    ]
                },
                {
                    id: 'q7',
                    question: 'Voc√™ testaria isso GRATUITAMENTE por 30 dias e me daria feedback?',
                    type: 'single',
                    options: [
                        { id: 'a', text: 'Sim, quando estiver pronto me avise', value: 'yes_notify' },
                        { id: 'b', text: 'Sim, mas s√≥ se for f√°cil de usar', value: 'yes_easy' },
                        { id: 'c', text: 'N√£o tenho interesse', value: 'no' }
                    ]
                }
            ];

            const handleAnswer = (questionId, optionId, customValue = '') => {
                const question = questions.find(q => q.id === questionId);
                
                if (question.type === 'single') {
                    setAnswers({
                        ...answers,
                        [questionId]: {
                            option: optionId,
                            custom: customValue
                        }
                    });
                } else {
                    const currentOptions = answers[questionId]?.options || {};
                    const currentCustoms = answers[questionId]?.customs || {};
                    
                    setAnswers({
                        ...answers,
                        [questionId]: {
                            options: {
                                ...currentOptions,
                                [optionId]: !currentOptions[optionId]
                            },
                            customs: {
                                ...currentCustoms,
                                [optionId]: customValue
                            }
                        }
                    });
                }
            };

            const canGoNext = () => {
                const currentQ = questions[currentQuestion];
                const currentAnswer = answers[currentQ.id];
                
                if (!currentAnswer) return false;
                
                if (currentQ.type === 'single') {
                    return !!currentAnswer.option;
                } else {
                    return currentAnswer.options && Object.values(currentAnswer.options).some(v => v);
                }
            };

            const goNext = () => {
                if (currentQuestion < questions.length - 1) {
                    setCurrentQuestion(currentQuestion + 1);
                } else {
                    setShowResults(true);
                }
            };

            const goBack = () => {
                setCurrentQuestion(currentQuestion - 1);
            };

            const handleSubmit = async () => {
                // Enviar para Google Sheets
                await sendToGoogleSheets(answers, contactInfo);
                
                // Abrir WhatsApp com mensagem formatada
                const score = calculateScore(answers);
                const quality = getQuality(score);
                
                let message = `üìã *RESPOSTA QUESTION√ÅRIO REPLYFASTLY*\n\n`;
                message += `üë§ *Dados:*\n`;
                message += `Nome: ${contactInfo.name}\n`;
                message += `WhatsApp: ${contactInfo.whatsapp}\n`;
                message += `Pa√≠s: ${contactInfo.country}\n\n`;
                message += `üìä *Score: ${score}/4 - ${quality}*\n\n`;
                message += `---\n\n`;
                
                questions.forEach((q, index) => {
                    const answer = answers[q.id];
                    if (answer) {
                        const option = q.options.find(opt => opt.id === answer.option);
                        message += `*${index + 1}. ${q.question}*\n`;
                        if (q.type === 'single') {
                            message += `R: ${option?.text || 'N/A'}\n`;
                            if (answer.custom) {
                                message += `Detalhes: ${answer.custom}\n`;
                            }
                        } else {
                            const selectedOptions = Object.keys(answer.options || {})
                                .filter(key => answer.options[key])
                                .map(key => q.options.find(opt => opt.id === key)?.text)
                                .filter(Boolean);
                            message += `R: ${selectedOptions.join(', ')}\n`;
                        }
                        message += `\n`;
                    }
                });
                
                message += `---\n`;
                message += `\nüì± *Envie essa mensagem e depois digite sua chave PIX na conversa*\n`;
                
                const whatsappUrl = `https://wa.me/5582999299818?text=${encodeURIComponent(message)}`;
                window.open(whatsappUrl, '_blank');
            };

            const wantsToTest = answers.q7?.option === 'a' || answers.q7?.option === 'b';

            if (showResults) {
                const score = calculateScore(answers);

                const getScoreMessage = (score) => {
                    if (score === 4) return "üî• Perfil ideal! Voc√™ √© exatamente nosso p√∫blico-alvo.";
                    if (score === 3) return "‚úÖ Muito promissor! Grande potencial de uso.";
                    if (score === 2) return "üí° Interessante. H√° demanda mas precisa se convencer.";
                    return "üìä Obrigado pelo feedback.";
                };

                return (
                    <div className="min-h-screen bg-gradient-to-br from-indigo-900 via-purple-900 to-slate-900 p-6 flex items-center justify-center">
                        <div className="max-w-2xl w-full bg-slate-800/50 backdrop-blur border border-slate-700 rounded-xl p-8 shadow-2xl">
                            <div className="text-center mb-8">
                                <div className="flex items-center justify-center gap-2 mb-4">
                                    <Zap className="w-12 h-12 text-indigo-400" />
                                    <h1 className="text-4xl font-bold text-white">ReplyFastly</h1>
                                </div>
                                <p className="text-slate-300">Obrigado por suas respostas valiosas!</p>
                            </div>

                            <div className="bg-gradient-to-br from-indigo-500/20 to-purple-500/20 border border-indigo-500/30 rounded-lg p-6 mb-6">
                                <h3 className="text-xl font-bold text-white mb-4">Pontua√ß√£o de Interesse</h3>
                                <div className="flex gap-2 mb-4">
                                    {[1, 2, 3, 4].map(i => (
                                        <div
                                            key={i}
                                            className={`h-3 flex-1 rounded ${i <= score ? 'bg-indigo-400' : 'bg-slate-600'}`}
                                        />
                                    ))}
                                </div>
                                <p className="text-slate-200 text-sm">
                                    {getScoreMessage(score)}
                                </p>
                            </div>

                            <div className="bg-slate-700/30 rounded-lg p-6 mb-6">
                                <h3 className="text-white font-semibold mb-4">Informa√ß√µes de contato</h3>
                                <div className="space-y-3">
                                    <input
                                        type="text"
                                        placeholder="Seu nome"
                                        value={contactInfo.name}
                                        onChange={(e) => setContactInfo({...contactInfo, name: e.target.value})}
                                        className="w-full bg-slate-700 border border-slate-600 rounded-lg px-4 py-2 text-white placeholder-slate-400 focus:outline-none focus:border-indigo-500"
                                    />
                                    <select
                                        value={contactInfo.country}
                                        onChange={(e) => handleCountryChange(e.target.value)}
                                        className="w-full bg-slate-700 border border-slate-600 rounded-lg px-4 py-2 text-white focus:outline-none focus:border-indigo-500"
                                    >
                                        <option value="BR">üáßüá∑ Brasil</option>
                                        <option value="PT">üáµüáπ Portugal</option>
                                        <option value="ES">üá™üá∏ Espanha</option>
                                        <option value="AU">üá¶üá∫ Austr√°lia</option>
                                        <option value="IN">üáÆüá≥ √çndia</option>
                                        <option value="OTHER">üåç Outro</option>
                                    </select>
                                    <input
                                        type="tel"
                                        placeholder="WhatsApp (com c√≥digo do pa√≠s)"
                                        value={contactInfo.whatsapp}
                                        onChange={(e) => setContactInfo({...contactInfo, whatsapp: e.target.value})}
                                        className="w-full bg-slate-700 border border-slate-600 rounded-lg px-4 py-2 text-white placeholder-slate-400 focus:outline-none focus:border-indigo-500"
                                    />
                                </div>
                            </div>

                            <div className="space-y-3">
                                <button
                                    onClick={handleSubmit}
                                    disabled={!contactInfo.name.trim()}
                                    className={`w-full py-4 px-6 rounded-lg font-bold text-lg transition-all flex items-center justify-center gap-2 shadow-lg ${
                                        contactInfo.name.trim()
                                            ? 'bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-700 hover:to-emerald-700 text-white'
                                            : 'bg-slate-700 text-slate-500 cursor-not-allowed'
                                    }`}
                                >
                                    <Zap className="w-6 h-6" />
                                    ENVIAR RESPOSTA
                                </button>

                                <p className="text-center text-slate-400 text-sm">
                                    Suas respostas ser√£o enviadas via WhatsApp de forma organizada
                                </p>
                            </div>

                            <div className="mt-6 p-4 bg-slate-700/20 border border-slate-600/50 rounded-lg text-center">
                                <p className="text-slate-300 text-sm mb-1">
                                    {wantsToTest 
                                        ? 'üéâ Voc√™ ser√° avisada quando o ReplyFastly estiver pronto!' 
                                        : 'Obrigado pelo seu tempo e feedback!'}
                                </p>
                                <p className="text-slate-400 text-xs">
                                    üí∞ N√£o esque√ßa de enviar sua chave PIX para receber os R$30
                                </p>
                            </div>
                        </div>
                    </div>
                );
            }

            const currentQ = questions[currentQuestion];
            const currentAnswer = answers[currentQ.id];

            return (
                <div className="min-h-screen bg-gradient-to-br from-indigo-900 via-purple-900 to-slate-900 p-6 flex items-center justify-center">
                    <div className="max-w-3xl w-full">
                        <div className="bg-slate-800/50 backdrop-blur border border-slate-700 rounded-xl p-8 shadow-2xl">
                            <div className="mb-6">
                                <div className="flex justify-between items-center mb-4">
                                    <div className="flex items-center gap-2">
                                        <Zap className="w-8 h-8 text-indigo-400" />
                                        <h2 className="text-2xl font-bold text-white">ReplyFastly</h2>
                                    </div>
                                    <span className="text-slate-400 text-sm">
                                        {currentQuestion + 1} de {questions.length}
                                    </span>
                                </div>
                                <div className="w-full bg-slate-700 rounded-full h-2">
                                    <div
                                        className="bg-gradient-to-r from-indigo-500 to-purple-500 h-2 rounded-full transition-all duration-300"
                                        style={{ width: `${((currentQuestion + 1) / questions.length) * 100}%` }}
                                    />
                                </div>
                            </div>

                            <div className="mb-8">
                                <h3 className="text-2xl font-semibold text-white mb-6">
                                    {currentQ.question}
                                </h3>

                                <div className="space-y-3">
                                    {currentQ.options.map((option) => {
                                        const isSelected = currentQ.type === 'single'
                                            ? currentAnswer?.option === option.id
                                            : currentAnswer?.options?.[option.id];

                                        return (
                                            <div key={option.id}>
                                                <button
                                                    onClick={() => handleAnswer(currentQ.id, option.id)}
                                                    className={`w-full text-left p-4 rounded-lg transition-all flex items-start gap-3 ${
                                                        isSelected
                                                            ? 'bg-indigo-500/30 border-2 border-indigo-400'
                                                            : 'bg-slate-700/30 border-2 border-slate-600 hover:border-slate-500'
                                                    }`}
                                                >
                                                    {currentQ.type === 'single' ? (
                                                        isSelected ? (
                                                            <CheckCircle2 className="w-6 h-6 text-indigo-400 flex-shrink-0 mt-0.5" />
                                                        ) : (
                                                            <Circle className="w-6 h-6 text-slate-500 flex-shrink-0 mt-0.5" />
                                                        )
                                                    ) : (
                                                        <div className={`w-6 h-6 rounded border-2 flex items-center justify-center flex-shrink-0 mt-0.5 ${
                                                            isSelected ? 'bg-indigo-500 border-indigo-400' : 'border-slate-500'
                                                        }`}>
                                                            {isSelected && <CheckCircle2 className="w-4 h-4 text-white" />}
                                                        </div>
                                                    )}
                                                    <span className={`${isSelected ? 'text-white font-medium' : 'text-slate-300'}`}>
                                                        {option.text}
                                                    </span>
                                                </button>

                                                {option.hasInput && isSelected && (
                                                    <input
                                                        type="text"
                                                        placeholder={option.inputLabel || "Especifique..."}
                                                        value={currentQ.type === 'single' ? (currentAnswer?.custom || '') : (currentAnswer?.customs?.[option.id] || '')}
                                                        onChange={(e) => {
                                                            e.stopPropagation();
                                                            handleAnswer(currentQ.id, option.id, e.target.value);
                                                        }}
                                                        onClick={(e) => e.stopPropagation()}
                                                        className="mt-2 ml-9 w-[calc(100%-2.25rem)] bg-slate-700 border border-slate-600 rounded-lg px-4 py-2 text-white placeholder-slate-400 focus:outline-none focus:border-indigo-500"
                                                    />
                                                )}
                                            </div>
                                        );
                                    })}
                                </div>
                            </div>

                            <div className="flex gap-3">
                                {currentQuestion > 0 && (
                                    <button
                                        onClick={goBack}
                                        className="flex-1 bg-slate-700 hover:bg-slate-600 text-white py-3 px-6 rounded-lg font-medium transition-all flex items-center justify-center gap-2"
                                    >
                                        <ChevronLeft className="w-5 h-5" />
                                        Voltar
                                    </button>
                                )}
                                
                                <button
                                    onClick={goNext}
                                    disabled={!canGoNext()}
                                    className={`flex-1 py-3 px-6 rounded-lg font-medium transition-all flex items-center justify-center gap-2 ${
                                        canGoNext()
                                            ? 'bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-700 hover:to-purple-700 text-white'
                                            : 'bg-slate-700 text-slate-500 cursor-not-allowed'
                                    }`}
                                >
                                    {currentQuestion === questions.length - 1 ? 'Finalizar' : 'Pr√≥xima'}
                                    <ChevronRight className="w-5 h-5" />
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            );
        }

        const root = createRoot(document.getElementById('root'));
        root.render(<ReplyFastlyValidationSurvey />);
    </script>
</body>
</html>
